<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ pageTitle }}</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/element-plus/dist/index.css"
    />
    <script src="/web/i18n.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://unpkg.com/element-plus"></script>
    <script src="https://unpkg.com/element-plus/dist/locale/zh-cn.js"></script>
    <script src="https://unpkg.com/element-plus/dist/locale/en.js"></script>
    <script src="https://unpkg.com/@element-plus/icons-vue"></script>
    <style>
      body {
        background: #0b0c10;
        color: #e7e9ea;
        font-family: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu,
          "Helvetica Neue", Arial;
        margin: 0;
        padding: 0;
      }
      .wrap {
        max-width: 1800px;
        margin: 0 auto;
        padding: 20px;
        background: #111418;
        min-height: 100vh;
      }
      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }
      .code {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
        font-size: 12px;
      }
      .log-content {
        max-width: 100%;
        overflow-x: auto;
        white-space: pre-wrap;
        word-break: break-all;
        background: #1a1d23;
        padding: 15px;
        border-radius: 4px;
        font-size: 12px;
        line-height: 1.6;
        max-height: 500px;
        overflow-y: auto;
      }
      .time-cell {
        color: #909399;
        font-size: 11px;
      }
      .size-cell {
        font-size: 11px;
      }
      .has-response {
        color: #67c23a;
      }
      .no-response {
        color: #909399;
      }
      /* 修复弹出框中字段宽度超出问题 */
      .el-descriptions__body .el-descriptions__cell {
        word-break: break-all;
        overflow-wrap: break-word;
      }
      .el-descriptions__label {
        white-space: nowrap;
      }
      .el-descriptions__content {
        word-break: break-all;
        overflow-wrap: break-word;
        max-width: 100%;
      }
      /* 确保操作按钮宽度一致 */
      .action-buttons .el-button {
        width: 100% !important;
        justify-content: center;
        margin-left: 0 !important; /* <--- 添加这一行 */
      }
      /* 语言切换按钮 */
      .lang-toggle {
        display: flex;
        gap: 5px;
      }
      .lang-btn {
        padding: 4px 12px;
        border: 1px solid #409eff;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s;
        background: transparent;
        color: #409eff;
      }
      .lang-btn.active {
        background: #409eff;
        color: #fff;
      }
      .lang-btn:hover:not(.active) {
        background: rgba(64, 158, 255, 0.1);
      }
    </style>
  </head>
  <body>
    <div id="app">
      <el-config-provider :locale="elLocale">
        <div class="wrap">
          <div class="header">
            <div>
              <h2 style="margin: 0">{{ t.httpTrafficLogs }}</h2>
              <p style="margin: 5px 0 0; color: #909399; font-size: 13px">
                {{ t.logsDescription }}
              </p>
            </div>
            <div style="display: flex; gap: 10px; align-items: center">
              <el-button @click="goBack" icon="Back">{{ t.back }}</el-button>
              <div class="lang-toggle">
                <button
                  class="lang-btn"
                  :class="{ active: currentLang === 'zh' }"
                  @click="switchLanguage('zh')"
                >
                  中文
                </button>
                <button
                  class="lang-btn"
                  :class="{ active: currentLang === 'en' }"
                  @click="switchLanguage('en')"
                >
                  English
                </button>
              </div>
              <el-button @click="loadLogs" icon="Refresh" :loading="loading"
                >{{ t.refresh }}</el-button
              >
              <el-popconfirm :title="t.clearAllLogs" @confirm="clearLogs">
                <template #reference>
                  <el-button type="danger" icon="Delete"
                    >{{ t.clear }}</el-button
                  >
                </template>
              </el-popconfirm>
            </div>
          </div>

          <el-card shadow="never">
            <template #header>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                "
              >
                <b
                  >{{ t.logsList }} ({{ t.total }} {{ total }} {{ t.items }})</b
                >
                <div style="display: flex; gap: 10px; align-items: center">
                  <span style="font-size: 13px; color: #909399"
                    >{{ t.autoRefresh }}:</span
                  >
                  <el-switch
                    v-model="autoRefresh"
                    @change="toggleAutoRefresh"
                  ></el-switch>
                  <el-input-number
                    v-model="refreshInterval"
                    :min="1"
                    :max="60"
                    size="small"
                    style="width: 100px"
                    @change="updateRefreshInterval"
                  ></el-input-number>
                  <span style="font-size: 13px; color: #909399"
                    >{{ t.seconds }}</span
                  >
                </div>
              </div>

              <div
                style="
                  margin-top: 12px;
                  display: flex;
                  flex-wrap: wrap;
                  gap: 10px;
                  align-items: center;
                "
              >
                <el-input
                  v-model="filterQ"
                  :placeholder="t.searchKeyword"
                  clearable
                  size="small"
                  style="width: 280px"
                  @keyup.enter="applyFilters"
                />

                <el-select
                  v-model="filterMethod"
                  clearable
                  filterable
                  size="small"
                  style="width: 140px"
                  :placeholder="t.method"
                >
                  <el-option
                    v-for="m in methodOptions"
                    :key="m"
                    :label="m"
                    :value="m"
                  />
                </el-select>

                <el-input
                  v-model="filterHost"
                  :placeholder="t.host"
                  clearable
                  size="small"
                  style="width: 240px"
                  @keyup.enter="applyFilters"
                />

                <el-input-number
                  v-model="filterStatus"
                  :min="0"
                  :max="999"
                  size="small"
                  style="width: 140px"
                  :placeholder="t.httpStatusCode"
                />

                <el-date-picker
                  v-model="filterTimeRange"
                  type="datetimerange"
                  size="small"
                  :start-placeholder="t.since"
                  :end-placeholder="t.until"
                />

                <div style="display: flex; align-items: center; gap: 6px">
                  <span style="font-size: 12px; color: #909399">{{
                    t.regex
                  }}</span>
                  <el-switch v-model="filterRegex"></el-switch>
                </div>

                <el-button size="small" type="primary" @click="applyFilters"
                  >{{ t.search }}</el-button
                >
                <el-button size="small" @click="resetFilters"
                  >{{ t.reset }}</el-button
                >
              </div>
            </template>

            <el-table
              :data="logs"
              size="small"
              style="width: 100%"
              v-loading="loading"
              max-height="calc(100vh - 300px)"
            >
              <el-table-column
                prop="id"
                label="ID"
                width="60"
              ></el-table-column>

              <el-table-column :label="t.time" width="160">
                <template #default="s">
                  <span class="time-cell"
                    >{{ formatTime(s.row.timestamp) }}</span
                  >
                </template>
              </el-table-column>

              <el-table-column :label="t.connection" width="280">
                <template #default="s">
                  <span class="code" style="font-size: 11px"
                    >{{ s.row.conn_id }}</span
                  >
                </template>
              </el-table-column>

              <el-table-column :label="t.method" width="80">
                <template #default="s">
                  <el-tag
                    v-if="s.row.method"
                    size="small"
                    :type="getMethodType(s.row.method)"
                  >
                    {{ s.row.method }}
                  </el-tag>
                  <span v-else class="muted">-</span>
                </template>
              </el-table-column>

              <el-table-column label="URL" min-width="250">
                <template #default="s">
                  <span class="code" style="font-size: 11px"
                    >{{ getFullUrl(s.row) }}</span
                  >
                </template>
              </el-table-column>

              <el-table-column :label="t.httpStatusCode" width="110">
                <template #default="s">
                  <el-tag
                    v-if="s.row.status_code"
                    size="small"
                    :type="getStatusType(s.row.status_code)"
                  >
                    {{ s.row.status_code }}
                  </el-tag>
                  <span v-else style="color: #909399">-</span>
                </template>
              </el-table-column>

              <el-table-column :label="t.status" width="220">
                <template #default="s">
                  <div
                    class="size-cell"
                    style="
                      display: flex;
                      gap: 8px;
                      align-items: center;
                      font-size: 11px;
                    "
                  >
                    <span
                      :class="s.row.request ? 'has-response' : 'no-response'"
                    >
                      ↑{{ s.row.request ? formatBytes(s.row.req_size) :
                      t.noRequest }}
                    </span>
                    <span
                      :class="s.row.response ? 'has-response' : 'no-response'"
                    >
                      ↓{{ s.row.response ? formatBytes(s.row.resp_size) :
                      t.noResponse }}
                    </span>
                    <span
                      v-if="s.row.duration_ms !== undefined"
                      style="color: #409eff"
                    >
                      ⏱{{ s.row.duration_ms }}ms
                    </span>
                  </div>
                </template>
              </el-table-column>

              <el-table-column :label="t.operation" width="120" fixed="right">
                <template #default="s">
                  <el-button
                    size="small"
                    @click="showPair(s.row)"
                    icon="Link"
                    :disabled="!s.row.request && !s.row.response"
                    :title="t.viewRequestResponse"
                    style="width: 100%"
                  >
                    {{ t.requestResponse }}
                  </el-button>
                </template>
              </el-table-column>
            </el-table>

            <!-- 分页 -->
            <div style="margin-top: 20px; text-align: center">
              <el-pagination
                v-model:current-page="currentPage"
                v-model:page-size="pageSize"
                :page-sizes="[10, 20, 50, 100]"
                :total="total"
                layout="total, sizes, prev, pager, next, jumper"
                @size-change="handleSizeChange"
                @current-change="handlePageChange"
              />
            </div>
          </el-card>

          <!-- 请求详情对话框 -->
          <el-dialog
            v-model="requestDialogVisible"
            :title="t.httpRequestDetails"
            width="80%"
            :close-on-click-modal="false"
          >
            <el-descriptions :column="2" border size="small">
              <el-descriptions-item label="ID"
                >{{ currentLog.id }}</el-descriptions-item
              >
              <el-descriptions-item :label="t.time"
                >{{ formatTime(currentLog.timestamp) }}</el-descriptions-item
              >
              <el-descriptions-item :label="t.connectionId" :span="2">
                <span style="word-break: break-all"
                  >{{ currentLog.conn_id }}</span
                >
              </el-descriptions-item>
              <el-descriptions-item :label="t.method">
                <el-tag
                  v-if="currentLog.method"
                  :type="getMethodType(currentLog.method)"
                  >{{ currentLog.method }}</el-tag
                >
              </el-descriptions-item>
              <el-descriptions-item :label="t.protocol"
                >{{ currentLog.protocol || '-' }}</el-descriptions-item
              >
              <el-descriptions-item label="Host">
                <span style="word-break: break-all"
                  >{{ currentLog.host || '-' }}</span
                >
              </el-descriptions-item>
              <el-descriptions-item :label="t.size"
                >{{ formatBytes(currentLog.req_size) }}</el-descriptions-item
              >
              <el-descriptions-item :label="t.url" :span="2">
                <div
                  style="
                    word-break: break-all;
                    max-width: 100%;
                    overflow-wrap: break-word;
                  "
                >
                  {{ currentLog.url || '-' }}
                </div>
              </el-descriptions-item>
            </el-descriptions>

            <div style="margin-top: 20px">
              <h4 style="margin: 0 0 10px">{{ t.fullRequest }}:</h4>
              <div class="log-content code">
                {{ currentLog.request || t.noRequestData }}
              </div>
            </div>

            <template #footer>
              <el-button @click="requestDialogVisible = false"
                >{{ t.close }}</el-button
              >
              <el-button type="primary" @click="copyContent(currentLog.request)"
                >{{ t.copyRequest }}</el-button
              >
            </template>
          </el-dialog>

          <!-- 响应详情对话框 -->
          <el-dialog
            v-model="responseDialogVisible"
            :title="t.httpResponseDetails"
            width="80%"
            :close-on-click-modal="false"
          >
            <el-descriptions :column="2" border size="small">
              <el-descriptions-item label="ID"
                >{{ currentLog.id }}</el-descriptions-item
              >
              <el-descriptions-item :label="t.time"
                >{{ formatTime(currentLog.timestamp) }}</el-descriptions-item
              >
              <el-descriptions-item :label="t.connectionId" :span="2">
                <span style="word-break: break-all"
                  >{{ currentLog.conn_id }}</span
                >
              </el-descriptions-item>
              <el-descriptions-item :label="t.size"
                >{{ formatBytes(currentLog.resp_size) }}</el-descriptions-item
              >
              <el-descriptions-item :label="t.requestMethod">
                <el-tag
                  v-if="currentLog.method"
                  :type="getMethodType(currentLog.method)"
                  >{{ currentLog.method }}</el-tag
                >
              </el-descriptions-item>
              <el-descriptions-item :label="t.compression" :span="2">
                <el-tag v-if="currentLog.is_gzipped" type="info" size="small"
                  >{{ t.gzipDecompressed }}</el-tag
                >
                <span v-else style="color: #909399">{{ t.notCompressed }}</span>
              </el-descriptions-item>
            </el-descriptions>

            <div style="margin-top: 20px">
              <h4 style="margin: 0 0 10px">{{ t.fullResponse }}:</h4>
              <div class="log-content code">
                {{ getDisplayResponse(currentLog) || t.noResponseData }}
              </div>
            </div>

            <template #footer>
              <el-button @click="responseDialogVisible = false"
                >{{ t.close }}</el-button
              >
              <el-button
                type="primary"
                @click="copyContent(getDisplayResponse(currentLog))"
                >{{ t.copyResponse }}</el-button
              >
            </template>
          </el-dialog>

          <!-- 请求响应配对对话框 -->
          <el-dialog
            v-model="pairDialogVisible"
            :title="t.httpRequestResponsePair"
            width="90%"
            :close-on-click-modal="false"
          >
            <el-descriptions
              :column="2"
              border
              size="small"
              style="margin-bottom: 20px"
            >
              <el-descriptions-item label="ID"
                >{{ currentLog.id }}</el-descriptions-item
              >
              <el-descriptions-item :label="t.time"
                >{{ formatTime(currentLog.timestamp) }}</el-descriptions-item
              >
              <el-descriptions-item :label="t.connectionId" :span="2">
                <span style="word-break: break-all"
                  >{{ currentLog.conn_id }}</span
                >
              </el-descriptions-item>
              <el-descriptions-item :label="t.method">
                <el-tag
                  v-if="currentLog.method"
                  :type="getMethodType(currentLog.method)"
                  >{{ currentLog.method }}</el-tag
                >
              </el-descriptions-item>
              <el-descriptions-item label="URL" :span="1">
                <div style="word-break: break-all">
                  {{ getFullUrl(currentLog) }}
                </div>
              </el-descriptions-item>
              <el-descriptions-item :label="t.requestSize"
                >{{ formatBytes(currentLog.req_size) }}</el-descriptions-item
              >
              <el-descriptions-item :label="t.responseSize"
                >{{ formatBytes(currentLog.resp_size) }}</el-descriptions-item
              >
              <el-descriptions-item
                v-if="currentLog.duration_ms !== undefined"
                :label="t.duration"
                :span="2"
              >
                {{ currentLog.duration_ms }}ms
              </el-descriptions-item>
            </el-descriptions>

            <el-row :gutter="20">
              <el-col :span="12">
                <div style="margin-bottom: 10px">
                  <h4 style="margin: 0; display: inline-block">
                    {{ t.request }} (Request)
                  </h4>
                </div>
                <div class="log-content code">
                  {{ currentLog.request || t.noRequestData }}
                </div>
              </el-col>
              <el-col :span="12">
                <div style="margin-bottom: 10px">
                  <h4 style="margin: 0; display: inline-block">
                    {{ t.response }} (Response)
                    <el-tag
                      v-if="currentLog.is_gzipped"
                      type="info"
                      size="small"
                      style="margin-left: 8px"
                      >{{ t.gzipDecompressed }}</el-tag
                    >
                  </h4>
                </div>
                <div class="log-content code">
                  {{ getDisplayResponse(currentLog) || t.noResponseData }}
                </div>
              </el-col>
            </el-row>

            <template #footer>
              <el-button @click="pairDialogVisible = false"
                >{{ t.close }}</el-button
              >
              <el-button type="success" @click="copyContent(currentLog.request)"
                >{{ t.copyRequest }}</el-button
              >
              <el-button
                type="primary"
                @click="copyContent(getDisplayResponse(currentLog))"
                >{{ t.copyResponse }}</el-button
              >
              <el-button type="warning" @click="copyBoth"
                >{{ t.copyBoth }}</el-button
              >
            </template>
          </el-dialog>
        </div>
      </el-config-provider>
    </div>

    <script>
      const { createApp, ref, onMounted, onUnmounted } = Vue;
      const { ElMessage, ElConfigProvider } = ElementPlus;

      const app = createApp({
        setup() {
          const logs = ref([]);
          const loading = ref(false);
          const requestDialogVisible = ref(false);
          const responseDialogVisible = ref(false);
          const pairDialogVisible = ref(false);
          const currentLog = ref({});
          const autoRefresh = ref(false);
          const refreshInterval = ref(60); // 默认60秒
          const currentPage = ref(1);
          const pageSize = ref(10);
          const total = ref(0);
          const currentLang = ref(i18n.getLanguage());
          const t = ref(i18n.getAll());

          const filterQ = ref("");
          const filterRegex = ref(false);
          const filterMethod = ref("");
          const filterHost = ref("");
          const filterStatus = ref(null);
          const filterTimeRange = ref([]);
          const methodOptions = [
            "GET",
            "POST",
            "PUT",
            "DELETE",
            "PATCH",
            "HEAD",
            "OPTIONS",
            "CONNECT",
          ];

          const updateTitle = () => {
            document.title =
              currentLang.value === "zh"
                ? i18nConfig.zh.titleLogs
                : i18nConfig.en.titleLogs;
          };
          updateTitle();
          const elLocale = ref(
            currentLang.value === "zh"
              ? ElementPlusLocaleZhCn
              : ElementPlusLocaleEn
          );
          let timer = null;

          const loadLogs = async () => {
            loading.value = true;
            try {
              const params = new URLSearchParams();
              params.set("page", String(currentPage.value));
              params.set("page_size", String(pageSize.value));

              const q = (filterQ.value || "").trim();
              if (q) {
                params.set("q", q);
                if (filterRegex.value) {
                  params.set("regex", "true");
                }
              }
              const method = (filterMethod.value || "").trim();
              if (method) {
                params.set("method", method);
              }
              const host = (filterHost.value || "").trim();
              if (host) {
                params.set("host", host);
              }
              if (
                filterStatus.value !== null &&
                filterStatus.value !== undefined &&
                filterStatus.value !== ""
              ) {
                params.set("status", String(filterStatus.value));
              }
              if (filterTimeRange.value && filterTimeRange.value.length === 2) {
                params.set(
                  "since",
                  new Date(filterTimeRange.value[0]).toISOString()
                );
                params.set(
                  "until",
                  new Date(filterTimeRange.value[1]).toISOString()
                );
              }

              const response = await fetch(
                `/api/http-logs?${params.toString()}`
              );
              const data = await response.json();
              logs.value = data.data || [];
              total.value = data.total || 0;
            } catch (e) {
              ElMessage.error(t.value.loadLogsFailed + ": " + e.message);
            } finally {
              loading.value = false;
            }
          };

          const applyFilters = async () => {
            currentPage.value = 1;
            await loadLogs();
          };

          const resetFilters = async () => {
            filterQ.value = "";
            filterRegex.value = false;
            filterMethod.value = "";
            filterHost.value = "";
            filterStatus.value = null;
            filterTimeRange.value = [];
            currentPage.value = 1;
            await loadLogs();
          };

          const clearLogs = async () => {
            try {
              await fetch("/api/http-logs", { method: "DELETE" });
              ElMessage.success(t.value.logsCleared);
              currentPage.value = 1;
              await loadLogs();
            } catch (e) {
              ElMessage.error(t.value.clearFailed + ": " + e.message);
            }
          };

          const showRequest = (log) => {
            currentLog.value = log;
            requestDialogVisible.value = true;
          };

          const showResponse = (log) => {
            currentLog.value = log;
            responseDialogVisible.value = true;
          };

          const showPair = (log) => {
            currentLog.value = log;
            pairDialogVisible.value = true;
          };

          const copyContent = (content) => {
            if (!content) {
              ElMessage.warning(t.value.noContentToCopy);
              return;
            }
            navigator.clipboard.writeText(content);
            ElMessage.success(t.value.copiedToClipboard);
          };

          const copyBoth = () => {
            const response = getDisplayResponse(currentLog.value);
            const reqLabel =
              currentLang.value === "zh" ? "HTTP 请求" : "HTTP Request";
            const respLabel =
              currentLang.value === "zh" ? "HTTP 响应" : "HTTP Response";
            const none = currentLang.value === "zh" ? "无" : "None";
            const content = `=== ${reqLabel} ===\n${
              currentLog.value.request || none
            }\n\n=== ${respLabel} ===\n${response || none}`;
            navigator.clipboard.writeText(content);
            ElMessage.success(t.value.copiedRequestAndResponse);
          };

          const getDisplayResponse = (log) => {
            // 如果有解压后的响应，优先显示解压后的内容
            if (log.is_gzipped && log.response_decoded) {
              return log.response_decoded;
            }
            return log.response;
          };

          const formatTime = (timestamp) => {
            if (!timestamp) return "-";
            const d = new Date(timestamp);
            const locale = currentLang.value === "zh" ? "zh-CN" : "en-US";
            return d.toLocaleString(locale, {
              year: "numeric",
              month: "2-digit",
              day: "2-digit",
              hour: "2-digit",
              minute: "2-digit",
              second: "2-digit",
              hour12: false,
            });
          };

          const formatBytes = (bytes) => {
            if (!bytes || bytes === 0) return "0 B";
            const k = 1024;
            const sizes = ["B", "KB", "MB", "GB"];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return (bytes / Math.pow(k, i)).toFixed(1) + " " + sizes[i];
          };

          const getMethodType = (method) => {
            const types = {
              GET: "success",
              POST: "primary",
              PUT: "warning",
              DELETE: "danger",
              PATCH: "warning",
              HEAD: "info",
              OPTIONS: "info",
            };
            return types[method] || "";
          };

          const getStatusType = (statusCode) => {
            const code = Number(statusCode);
            if (!Number.isFinite(code) || code <= 0) return "info";
            if (code >= 200 && code < 300) return "success";
            if (code >= 300 && code < 400) return "info";
            if (code >= 400 && code < 500) return "warning";
            return "danger";
          };

          const getFullUrl = (log) => {
            if (!log.host && !log.url) return "-";

            // Extract protocol from the request if available
            let protocol = "http";
            if (log.protocol && log.protocol.toLowerCase().includes("https")) {
              protocol = "https";
            }

            const host = log.host || "";
            const url = log.url || "";

            // If URL already contains protocol, return as is
            if (url.startsWith("http://") || url.startsWith("https://")) {
              return url;
            }

            // Construct full URL
            if (host && url) {
              return `${protocol}://${host}${url}`;
            } else if (host) {
              return `${protocol}://${host}`;
            } else {
              return url;
            }
          };

          const goBack = () => {
            window.location.href = "/web/index.html";
          };

          const handlePageChange = (page) => {
            currentPage.value = page;
            loadLogs();
          };

          const handleSizeChange = (size) => {
            pageSize.value = size;
            currentPage.value = 1;
            loadLogs();
          };

          const toggleAutoRefresh = (val) => {
            if (val) {
              startAutoRefresh();
            } else {
              stopAutoRefresh();
            }
          };

          const updateRefreshInterval = () => {
            if (autoRefresh.value) {
              stopAutoRefresh();
              startAutoRefresh();
            }
          };

          const startAutoRefresh = () => {
            timer = setInterval(loadLogs, refreshInterval.value * 1000);
          };

          const stopAutoRefresh = () => {
            if (timer) {
              clearInterval(timer);
              timer = null;
            }
          };

          onMounted(() => {
            loadLogs();
            if (autoRefresh.value) {
              startAutoRefresh();
            }
          });

          onUnmounted(() => {
            stopAutoRefresh();
          });

          const switchLanguage = (lang) => {
            updateTitle();
            i18n.setLanguage(lang);
            currentLang.value = lang;
            t.value = i18n.getAll();
            // Update Element Plus locale
            elLocale.value =
              lang === "zh" ? ElementPlusLocaleZhCn : ElementPlusLocaleEn;
          };

          return {
            logs,
            loading,
            requestDialogVisible,
            responseDialogVisible,
            pairDialogVisible,
            currentLog,
            autoRefresh,
            refreshInterval,
            currentPage,
            pageSize,
            total,
            loadLogs,
            clearLogs,
            showRequest,
            showResponse,
            showPair,
            copyContent,
            copyBoth,
            formatTime,
            formatBytes,
            getMethodType,
            getStatusType,
            goBack,
            getDisplayResponse,
            getFullUrl,
            handlePageChange,
            handleSizeChange,
            toggleAutoRefresh,
            updateRefreshInterval,
            currentLang,
            t,
            switchLanguage,
            elLocale,
            filterQ,
            filterRegex,
            filterMethod,
            filterHost,
            filterStatus,
            filterTimeRange,
            methodOptions,
            applyFilters,
            resetFilters,
          };
        },
      });

      for (const [key, component] of Object.entries(ElementPlusIconsVue)) {
        app.component(key, component);
      }
      app.use(ElementPlus).mount("#app");
    </script>
  </body>
</html>
